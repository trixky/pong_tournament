{"ast":null,"code":"import consumer from \"./consumer\";\nimport { router } from \"../BackboneRouter/application_router\";\nimport { Player, Game, Ball } from \"../utils/game_class\";\n\nvar game_channel = function game_channel(guest, channel_name, game) {\n  var new_channel = consumer.subscriptions.create({\n    channel: \"GameChannel\",\n    room: channel_name\n  }, {\n    connected: function connected() {\n      var _this = this;\n\n      this.data = game;\n      this.guest = guest;\n      router.on(\"route\", function () {\n        if (_this.intervalSet == true) {\n          clearInterval(_this.interval);\n          _this.intervalSet = false;\n        }\n\n        if (_this.started == true) _this.unsubscribe();\n      });\n    },\n    disconnected: function disconnected() {\n      clearInterval(this.interval);\n      this.interval = false;\n    },\n    rejected: function rejected() {\n      $(\".Center\").html(\"\\n            <div class=\\\"PopUp\\\">\\n                <h1> ERROR: YOU ARE ALREADY PLAYING </h1>\\n            </div>\\n          \");\n    },\n    received: function received(data) {\n      var _this2 = this;\n\n      if (data[\"ended\"]) {\n        this.ended_game_error();\n      }\n\n      if (data[\"end_game\"]) this.end_game();\n\n      if (data[\"rebound\"] && data[\"pseudo\"] != Cookies.get(\"pseudo\")) {\n        this.ball.object.x = data[\"x\"];\n        this.ball.object.y = data[\"y\"];\n        this.ball.x_dir = data['x_dir'];\n        this.ball.y_dir = data['y_dir'];\n      } else if (data[\"start\"] && this.started != true) {\n        if (this.stageInit != true) {\n          this.stageInit = true;\n          this.started = true;\n          this.player_1 = $(\"#player1\").text();\n          this.player_2 = $(\"#player2\").text();\n          this.host_name = data[\"host\"];\n          if (data[\"host\"] == Cookies.get(\"pseudo\")) this.host = true;else this.host = false;\n          this.game = new Game(data[\"width\"], data[\"height\"], data[\"max_score\"], \"pongBoard\");\n          this.p1 = new Player();\n          this.p2 = new Player();\n          this.ball = new Ball(data[\"speed\"], data[\"x_dir\"], data[\"y_dir\"]);\n          this.init_stage(data);\n          if (this.guest == false) this.initListenner();\n        }\n      } else if (data[\"break\"]) {\n        this.interval = false;\n        clearInterval(this.interval);\n      } else if (data[\"move_up\"] && data[\"move_up\"] != Cookies.get(\"pseudo\")) {\n        if (this.guest) {\n          if (this.host_name != data[\"move_up\"]) this.p2.up = data[\"up\"];else this.p1.up = data[\"up\"];\n        } else {\n          if (this.host) this.p2.up = data[\"up\"];else this.p1.up = data[\"up\"];\n        }\n      } else if (data[\"move_down\"] && data[\"move_down\"] != Cookies.get(\"pseudo\")) {\n        if (this.guest) {\n          if (this.host_name != data[\"move_down\"]) this.p2.down = data[\"down\"];else this.p1.down = data[\"down\"];\n        } else {\n          if (this.host) this.p2.down = data[\"down\"];else this.p1.down = data[\"down\"];\n        }\n      }\n\n      if (data[\"go\"] || data[\"catch\"]) {\n        this.score_p1 = data[\"score_p1\"];\n        this.score_p2 = data[\"score_p2\"];\n        this.player_1 = data[\"player_1\"];\n        this.player_2 = data[\"player_2\"];\n        $(\"#score\").html(\"<span id=\\\"player1\\\">\".concat(this.player_1, \"</span>: <span id=\\\"scoreP1\\\">\").concat(this.score_p1, \"</span> <span class=\\\"VS\\\">VS</span> <span id=\\\"player2\\\">\").concat(this.player_2, \"</span>: <span id=\\\"scoreP2\\\">\").concat(this.score_p2, \"</span>\"));\n        this.intervalSet = true;\n        this.interval = setInterval(function () {\n          _this2.move(_this2.game, _this2.p1, _this2.p2, _this2.ball, _this2.socket);\n        }, 5);\n      } else if (data[\"goal\"]) {\n        clearInterval(this.interval);\n        this.intervalSet = false;\n\n        if (data[\"goal\"] == \"p1\") {\n          this.p1.score += 1;\n        } else if (data[\"goal\"] == \"p2\") {\n          this.p2.score += 1;\n        }\n\n        this.ball.x_dir = data[\"x_dir\"];\n        this.ball.y_dir = data[\"y_dir\"];\n        this.ball.object.x = data[\"x\"];\n        this.ball.object.y = data[\"y\"];\n        this.p1.object.x = data[\"p1_x\"];\n        this.p1.object.y = data[\"p1_y\"];\n        this.p2.object.x = data[\"p2_x\"];\n        this.p2.object.y = data[\"p2_y\"];\n        this.game.stage.update();\n      } else if (data[\"3\"]) $(\"#score\").text(\"3\");else if (data[\"2\"]) $(\"#score\").text(\"2\");else if (data[\"1\"]) $(\"#score\").text(\"1\");else if (data[\"forfait\"]) {\n        if (this.guest == false) this.forfait(data[\"forfait\"]);else router.navigate(\"connected/play\", {\n          trigger: true\n        });\n      }\n    },\n    move: function move(game, p1, p2, ball, socket) {\n      var canvs = document.getElementById(\"pongBoard\");\n      var middle;\n      if (p1.up == 1 && p1.object.y - this.hgt(1) >= -5) p1.object.y -= this.hgt(0.5);else if (p1.down == 1 && p1.object.y + this.hgt(17) <= canvs.height - 55) p1.object.y += this.hgt(0.5);\n      if (p2.up == 1 && p2.object.y - this.hgt(1) >= -5) p2.object.y -= this.hgt(0.5);else if (p2.down == 1 && p2.object.y + this.hgt(17) <= canvs.height - 55) p2.object.y += this.hgt(0.5);\n\n      if (ball.object.y > p1.object.y && ball.object.y < p1.object.y + game.height() && ball.object.x > p1.object.x + game.width() && ball.object.x + ball.x_dir < p1.object.x + game.width()) {\n        middle = p1.object.y + game.height() / 2;\n        ball.y_dir = (ball.object.y - middle) / (game.height() / 2) * (ball.max_speed * 0.75);\n        ball.x_dir = Math.sqrt(Math.pow(ball.max_speed, 2) - Math.pow(ball.y_dir, 2));\n\n        if (this.host && !this.guest) {\n          this.send({\n            rebound: true,\n            x_dir: ball.x_dir,\n            y_dir: ball.y_dir,\n            x: ball.object.x,\n            y: ball.object.y\n          });\n        }\n      } else if (ball.object.y > p2.object.y && ball.object.y < p2.object.y + game.height() && ball.object.x < p2.object.x && ball.object.x + ball.x_dir > p2.object.x) {\n        middle = p2.object.y + game.height() / 2;\n        ball.y_dir = (ball.object.y - middle) / (game.height() / 2) * (ball.max_speed * 0.75);\n        ball.x_dir = Math.sqrt(Math.pow(ball.max_speed, 2) - Math.pow(ball.y_dir, 2)) * -1;\n\n        if (!this.host && !this.guest) {\n          this.send({\n            rebound: true,\n            x_dir: ball.x_dir,\n            y_dir: ball.y_dir,\n            x: ball.object.x,\n            y: ball.object.y\n          });\n        }\n      } else if (ball.object.y > 0 && ball.object.y + ball.y_dir < 0) {\n        ball.y_dir *= -1;\n      } else if (ball.object.y < canvs.height && ball.object.y + ball.y_dir > canvs.height) {\n        ball.y_dir *= -1;\n      } else {\n        ball.object.x += ball.x_dir;\n        ball.object.y += ball.y_dir;\n      }\n\n      game.stage.update();\n    },\n    init_stage: function init_stage(data) {\n      this.ball.object.graphics.beginFill(\"white\").drawCircle(0, 0, data[\"ball_size\"]);\n      this.ball.object.x = data[\"x\"];\n      this.ball.object.y = data[\"y\"];\n      this.p1.object.graphics.beginFill(\"white\").drawRoundRect(0, 0, this.game.width(), this.game.height(), 0);\n      this.p1.object.x = data[\"p1_x\"];\n      this.p1.object.y = data[\"p1_y\"];\n      this.p2.object.graphics.beginFill(\"white\").drawRoundRect(0, 0, this.game.width(), this.game.height(), 0);\n      this.p2.object.x = data[\"p2_x\"];\n      this.p2.object.y = data[\"p2_y\"];\n      this.game.stage.addChild(this.p1.object);\n      this.game.stage.addChild(this.p2.object);\n      this.game.stage.addChild(this.ball.object);\n      this.game.stage.update();\n    },\n    initListenner: function initListenner() {\n      var self = this;\n      $(\"body\").keyup(function () {\n        self.keyup_event();\n      });\n      $(\"body\").keydown(function () {\n        self.keydown_event();\n      });\n    },\n    keyup_event: function keyup_event() {\n      if ($(\"#pongBoard\").length) {\n        if (event.code == \"ArrowDown\") {\n          if (this.host == false && this.p2.down != 0) this.p2.down = 0;else if (this.host && this.p1.down != 0) this.p1.down = 0;\n          this.send({\n            move_down: true,\n            down: 0\n          });\n        } else if (event.code == \"ArrowUp\") {\n          if (this.host == false && this.p2.up != 0) this.p2.up = 0;else if (this.host && this.p1.up != 0) this.p1.up = 0;\n          this.send({\n            move_up: true,\n            up: 0\n          });\n        }\n      }\n    },\n    keydown_event: function keydown_event() {\n      if ($(\"#pongBoard\").length) {\n        if (event.code == \"ArrowDown\") {\n          if (this.host == false && this.p2.down != 1) this.p2.down = 1;else if (this.host && this.p1.down != 1) this.p1.down = 1;\n          this.send({\n            move_down: true,\n            down: 1\n          });\n        } else if (event.code == \"ArrowUp\") {\n          if (this.host == false && this.p2.up != 1) this.p2.up = 1;else if (this.host && this.p1.up != 1) this.p1.up = 1;\n          this.send({\n            move_up: true,\n            up: 1\n          });\n        }\n      }\n    },\n    wdh: function wdh(number) {\n      var canvs = document.getElementById(\"pongBoard\");\n      if (canvs) number = number / 100 * canvs.width;\n      return number;\n    },\n    hgt: function hgt(number) {\n      var canvs = document.getElementById(\"pongBoard\");\n      if (canvs) number = number / 100 * canvs.height;\n      return number;\n    },\n    end_game: function end_game() {\n      this.unsubscribe();\n      clearInterval(this.interval);\n      var winner;\n      if (this.p1.score == 10) winner = this.player_1;else winner = this.player_2;\n      $(\"#score\").hide();\n      if ($(\".BackClick\").length == 0) $(\"body\").append(\"<div class=\\\"BackClick\\\"></div>\");\n      if ($(\"#partyEnding\").length == 0) $(\".Center\").append(\"\\n                <div class=\\\"PopUp\\\" id=\\\"partyEnding\\\">\\n                    <h1> \".concat(winner, \" <span style=\\\"color: green\\\">WIN</span> THE GAME </h1>\\n                    <button id=\\\"endMatchButton\\\"> Go back to menu </button>\\n                </div>\\n            \"));\n      $(\".BackClick\").click(function () {\n        router.navigate(\"connected/play\", {\n          trigger: true\n        });\n        $(\".BackClick\").remove();\n      });\n      $(\"#endMatchButton\").click(function () {\n        router.navigate(\"connected/play\", {\n          trigger: true\n        });\n        $(\".BackClick\").remove();\n      });\n    },\n    ended_game_error: function ended_game_error() {\n      this.unsubscribe();\n      clearInterval(this.interval);\n      this.interval = 0;\n      router.navigate(\"connected/play\", {\n        trigger: true\n      });\n    },\n    forfait: function forfait(looser) {\n      this.unsubscribe();\n      clearInterval(this.interval);\n      this.interval = 0;\n      var sentence;\n      if (looser == Cookies.get(\"pseudo\")) sentence = \"Game ended, you left the party\";else sentence = \"You win, \".concat(looser, \" left the party\");\n      $(\"#score\").hide();\n      if ($(\".BackClick\").length == 0) $(\"body\").append(\"<div class=\\\"BackClick\\\"></div>\");\n      if ($(\"#partyEnding\").length == 0) $(\".Center\").append(\"\\n                <div class=\\\"PopUp\\\" id=\\\"partyEnding\\\">\\n                    <h1> \".concat(sentence, \" </h1>\\n                    <button id=\\\"endMatchButton\\\"> Go back to menu </button>\\n                </div>\\n            \"));\n      $(\".BackClick\").click(function () {\n        router.navigate(\"connected/play\", {\n          trigger: true\n        });\n        $(\".BackClick\").remove();\n      });\n      $(\"#endMatchButton\").click(function () {\n        router.navigate(\"connected/play\", {\n          trigger: true\n        });\n        $(\".BackClick\").remove();\n      });\n    }\n  });\n  return new_channel;\n};\n\nexport { game_channel };","map":{"version":3,"sources":["/home/mathis/Documents/dede/app/javascript/channels/game_channel.js"],"names":["consumer","router","Player","Game","Ball","game_channel","guest","channel_name","game","new_channel","subscriptions","create","channel","room","connected","data","on","intervalSet","clearInterval","interval","started","unsubscribe","disconnected","rejected","$","html","received","ended_game_error","end_game","Cookies","get","ball","object","x","y","x_dir","y_dir","stageInit","player_1","text","player_2","host_name","host","p1","p2","init_stage","initListenner","up","down","score_p1","score_p2","setInterval","move","socket","score","stage","update","forfait","navigate","trigger","canvs","document","getElementById","middle","hgt","height","width","max_speed","Math","sqrt","pow","send","rebound","graphics","beginFill","drawCircle","drawRoundRect","addChild","self","keyup","keyup_event","keydown","keydown_event","length","event","code","move_down","move_up","wdh","number","winner","hide","append","click","remove","looser","sentence"],"mappings":"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","sourcesContent":["import consumer from \"./consumer\"\nimport {router} from \"../BackboneRouter/application_router\"\nimport {Player, Game, Ball} from \"../utils/game_class\"\n\nvar game_channel = (guest, channel_name, game) => {\n    var new_channel = consumer.subscriptions.create({ channel: \"GameChannel\", room: channel_name}, {\n        connected() {\n            this.data = game;\n            this.guest = guest\n            router.on(\"route\", () => {\n                if (this.intervalSet == true)\n                {\n                    clearInterval(this.interval);\n                    this.intervalSet = false;\n                }\n                if (this.started == true)\n                    this.unsubscribe();\n            });\n        },\n  \n      disconnected() {\n        clearInterval(this.interval);\n        this.interval = false;\n      },\n  \n      rejected() {\n          $(\".Center\").html(`\n            <div class=\"PopUp\">\n                <h1> ERROR: YOU ARE ALREADY PLAYING </h1>\n            </div>\n          `);\n      },\n      received(data) {\n        if (data[\"ended\"])\n        {\n            this.ended_game_error();\n        }\n        if (data[\"end_game\"])\n            this.end_game();\n        if (data[\"rebound\"] && data[\"pseudo\"] != Cookies.get(\"pseudo\"))\n        {\n            this.ball.object.x = data[\"x\"];\n            this.ball.object.y = data[\"y\"];\n            this.ball.x_dir = data['x_dir'];\n            this.ball.y_dir = data['y_dir'];\n\n        }\n        else if (data[\"start\"] && this.started != true)\n        {\n            if (this.stageInit != true)\n            {\n                this.stageInit = true\n                this.started = true;\n                this.player_1 = $(\"#player1\").text();\n                this.player_2 = $(\"#player2\").text();\n                this.host_name = data[\"host\"]\n                if (data[\"host\"] == Cookies.get(\"pseudo\"))\n                    this.host = true;\n                else\n                    this.host = false;\n                this.game = new Game(data[\"width\"], data[\"height\"], data[\"max_score\"], \"pongBoard\");\n                this.p1 = new Player;\n                this.p2 = new Player;\n                this.ball = new Ball(data[\"speed\"], data[\"x_dir\"], data[\"y_dir\"]);\n                this.init_stage(data);\n                if (this.guest == false)\n                    this.initListenner();           \n            }\n        }\n        else if (data[\"break\"])\n        {\n            this.interval = false;\n            clearInterval(this.interval);\n        }\n        else if (data[\"move_up\"] && (data[\"move_up\"] != Cookies.get(\"pseudo\")))\n        {\n            if (this.guest)\n            {\n                if (this.host_name != data[\"move_up\"])\n                    this.p2.up = data[\"up\"];\n                else\n                    this.p1.up = data[\"up\"];\n            }\n            else\n            {\n                if (this.host)\n                    this.p2.up = data[\"up\"];\n                else\n                    this.p1.up = data[\"up\"];\n            }\n        }\n        else if (data[\"move_down\"] && (data[\"move_down\"] != Cookies.get(\"pseudo\")))\n        {\n            if (this.guest)\n            {\n                if (this.host_name != data[\"move_down\"])\n                    this.p2.down = data[\"down\"];\n                else\n                    this.p1.down = data[\"down\"]\n            }\n            else\n            {\n                if (this.host)\n                    this.p2.down = data[\"down\"];\n                else\n                    this.p1.down = data[\"down\"]\n            }\n        }\n        if (data[\"go\"] || data[\"catch\"])\n        {\n            this.score_p1 = data[\"score_p1\"];\n            this.score_p2 = data[\"score_p2\"];\n            this.player_1 = data[\"player_1\"];\n            this.player_2 = data[\"player_2\"];\n            $(\"#score\").html(`<span id=\"player1\">${this.player_1}</span>: <span id=\"scoreP1\">${this.score_p1}</span> <span class=\"VS\">VS</span> <span id=\"player2\">${this.player_2}</span>: <span id=\"scoreP2\">${this.score_p2}</span>`)\n            this.intervalSet = true;\n            this.interval = setInterval(()=>{\n                this.move(this.game, this.p1, this.p2, this.ball, this.socket)\n            }, 5);\n        }\n        else if (data[\"goal\"])\n        {\n            clearInterval(this.interval);\n            this.intervalSet = false;\n            if (data[\"goal\"] == \"p1\")\n            {\n                this.p1.score += 1;\n            }\n            else if (data[\"goal\"] == \"p2\")\n            {\n                this.p2.score += 1;\n            }\n            this.ball.x_dir = data[\"x_dir\"];\n            this.ball.y_dir = data[\"y_dir\"];\n            this.ball.object.x = data[\"x\"];\n            this.ball.object.y = data[\"y\"];\n            this.p1.object.x = data[\"p1_x\"];\n            this.p1.object.y = data[\"p1_y\"];\n            this.p2.object.x = data[\"p2_x\"];\n            this.p2.object.y = data[\"p2_y\"];\n            this.game.stage.update();\n        }\n        else if (data[\"3\"])\n            $(\"#score\").text(\"3\");\n        else if (data[\"2\"])\n            $(\"#score\").text(\"2\");\n        else if (data[\"1\"])\n            $(\"#score\").text(\"1\");\n        else if (data[\"forfait\"])\n        {\n            if (this.guest == false)\n                this.forfait(data[\"forfait\"]);\n            else\n                router.navigate(\"connected/play\", {trigger: true});\n        }\n    },\n    move : function (game, p1, p2, ball, socket)\n    {\n        var canvs = document.getElementById(\"pongBoard\");\n        var middle;\n\n        if (p1.up == 1 && p1.object.y - this.hgt(1) >= -5)\n            p1.object.y -= this.hgt(0.5);\n        else if (p1.down == 1 && p1.object.y + this.hgt(17) <= canvs.height - 55)\n            p1.object.y += this.hgt(0.5);\n        if (p2.up == 1 && p2.object.y - this.hgt(1) >= -5)\n            p2.object.y -= this.hgt(0.5);\n        else if (p2.down == 1 && p2.object.y + this.hgt(17) <= canvs.height - 55)\n            p2.object.y += this.hgt(0.5);\n        if ((ball.object.y > p1.object.y && ball.object.y < p1.object.y + game.height() && ball.object.x > p1.object.x + game.width() && ball.object.x + ball.x_dir < p1.object.x + game.width()))\n        {\n            middle = p1.object.y + game.height() / 2;\n            ball.y_dir = (ball.object.y - middle) / (game.height() / 2) * (ball.max_speed * 0.75);\n            ball.x_dir = Math.sqrt(Math.pow(ball.max_speed, 2) - Math.pow(ball.y_dir, 2));\n            if (this.host && !this.guest)\n            {\n                this.send({\n                    rebound: true,\n                    x_dir: ball.x_dir,\n                    y_dir: ball.y_dir,\n                    x: ball.object.x,\n                    y: ball.object.y\n                })\n            }\n        }\n        else if ((ball.object.y > p2.object.y && ball.object.y < p2.object.y + game.height() && ball.object.x < p2.object.x && ball.object.x + ball.x_dir > p2.object.x))\n        {\n            middle = p2.object.y + game.height() / 2;\n            ball.y_dir = (ball.object.y - middle) / (game.height() / 2) * (ball.max_speed * 0.75);\n            ball.x_dir = Math.sqrt(Math.pow(ball.max_speed, 2) - Math.pow(ball.y_dir, 2)) * -1;\n            if (!this.host && !this.guest)\n            {\n                this.send({\n                    rebound: true,\n                    x_dir: ball.x_dir,\n                    y_dir: ball.y_dir,\n                    x: ball.object.x,\n                    y: ball.object.y\n                })\n            }\n        }\n        else if (ball.object.y > 0 && ball.object.y + ball.y_dir < 0)\n        {\n            ball.y_dir *= -1;\n        }\n        else if (ball.object.y < canvs.height && ball.object.y + ball.y_dir > canvs.height)\n        {\n            ball.y_dir *= -1;\n        }\n        else\n        {\n            ball.object.x += ball.x_dir;\n            ball.object.y += ball.y_dir;\n        }\n        game.stage.update();\n      },\n    init_stage: function (data)\n    {\n        this.ball.object.graphics.beginFill(\"white\").drawCircle(0, 0, data[\"ball_size\"]);\n        this.ball.object.x = data[\"x\"];\n        this.ball.object.y = data[\"y\"];\n        this.p1.object.graphics.beginFill(\"white\").drawRoundRect(0, 0, this.game.width(), this.game.height(),  0);\n        this.p1.object.x = data[\"p1_x\"];\n        this.p1.object.y = data[\"p1_y\"];\n        this.p2.object.graphics.beginFill(\"white\").drawRoundRect(0, 0, this.game.width(), this.game.height(),  0);\n        this.p2.object.x = data[\"p2_x\"];\n        this.p2.object.y = data[\"p2_y\"];\n        this.game.stage.addChild(this.p1.object);\n        this.game.stage.addChild(this.p2.object);\n        this.game.stage.addChild(this.ball.object);\n        this.game.stage.update();\n      },\n    initListenner: function ()\n    {\n        var self = this;\n        $(\"body\").keyup(function(){\n            self.keyup_event();\n        });\n        $(\"body\").keydown(function(){\n            self.keydown_event();\n        });\n      },\n    keyup_event: function ()\n    {\n        if ($(\"#pongBoard\").length)\n        {\n            if (event.code == \"ArrowDown\")\n            {\n                if (this.host == false && this.p2.down != 0)\n                    this.p2.down = 0;\n                else if (this.host && this.p1.down != 0)\n                    this.p1.down = 0;\n                this.send({\n                    move_down: true,\n                    down: 0\n                })\n            }\n            else if (event.code == \"ArrowUp\")\n            {\n                if (this.host == false && this.p2.up != 0)\n                    this.p2.up = 0;\n                else if (this.host && this.p1.up != 0)\n                    this.p1.up = 0\n                this.send({\n                    move_up: true,\n                    up: 0\n                })\n            }\n        }\n    },\n    keydown_event: function ()\n    {\n        if ($(\"#pongBoard\").length)\n        {\n            if (event.code == \"ArrowDown\")\n            {\n                if (this.host == false && this.p2.down != 1)\n                    this.p2.down = 1;\n                else if (this.host && this.p1.down != 1)\n                    this.p1.down = 1;\n                this.send({\n                    move_down: true,\n                    down: 1\n                })\n            }\n            else if (event.code == \"ArrowUp\")\n            {\n                if (this.host == false && this.p2.up != 1)\n                    this.p2.up = 1;\n                else if (this.host && this.p1.up != 1)\n                    this.p1.up = 1;\n                this.send({\n                    move_up: true,\n                    up: 1\n                })\n            }\n        }\n    },\n    wdh: function (number)\n    {\n        var canvs = document.getElementById(\"pongBoard\");\n        if (canvs)\n            number = number / 100 * canvs.width;\n        return number;\n    },\n    hgt : function (number)\n    {\n        var canvs = document.getElementById(\"pongBoard\");\n        if (canvs)\n            number = number / 100 * canvs.height;\n        return number;\n    },\n    end_game: function()\n    {\n        this.unsubscribe();\n        clearInterval(this.interval);\n        var winner;\n        if (this.p1.score == 10)\n            winner = this.player_1\n        else\n            winner = this.player_2\n        $(\"#score\").hide();\n        if ($(\".BackClick\").length == 0)\n            $(\"body\").append(`<div class=\"BackClick\"></div>`);\n        if ($(\"#partyEnding\").length == 0)\n            $(\".Center\").append(`\n                <div class=\"PopUp\" id=\"partyEnding\">\n                    <h1> ${winner} <span style=\"color: green\">WIN</span> THE GAME </h1>\n                    <button id=\"endMatchButton\"> Go back to menu </button>\n                </div>\n            `);\n        $(\".BackClick\").click(()=>{\n            router.navigate(\"connected/play\", {trigger: true});\n            $(\".BackClick\").remove();\n        });\n        $(\"#endMatchButton\").click(()=>{\n            router.navigate(\"connected/play\", {trigger: true});\n            $(\".BackClick\").remove();\n        })\n    },\n    ended_game_error: function()\n    {\n        this.unsubscribe();\n        clearInterval(this.interval);\n        this.interval = 0\n        router.navigate(\"connected/play\", {trigger: true});\n    },\n    forfait : function (looser)\n    {\n        this.unsubscribe();\n        clearInterval(this.interval);\n        this.interval = 0\n        var sentence;\n        if (looser == Cookies.get(\"pseudo\"))\n            sentence = `Game ended, you left the party`;\n        else\n            sentence = `You win, ${looser} left the party`;\n        $(\"#score\").hide();\n        if ($(\".BackClick\").length == 0)\n            $(\"body\").append(`<div class=\"BackClick\"></div>`);\n        if ($(\"#partyEnding\").length == 0)\n            $(\".Center\").append(`\n                <div class=\"PopUp\" id=\"partyEnding\">\n                    <h1> ${sentence} </h1>\n                    <button id=\"endMatchButton\"> Go back to menu </button>\n                </div>\n            `);\n        $(\".BackClick\").click(()=>{\n            router.navigate(\"connected/play\", {trigger: true});\n            $(\".BackClick\").remove();\n        });\n        $(\"#endMatchButton\").click(()=>{\n            router.navigate(\"connected/play\", {trigger: true});\n            $(\".BackClick\").remove();\n        })\n    }\n    });\n    return (new_channel);\n  }\n  \n  export {game_channel}\n  "]},"metadata":{},"sourceType":"module"}